# Лабораторная работа №2: Трекинг объекта по ключевым точкам

## Описание.
Программа должна принимать на видео, первым кадром которого является крупное изображение объекта, положение которого необходимо отследить. На каждом кадре видео, где данный объект виден, вокруг него должна рисоваться рамка с подписью. В примере объект прямоугольный и плоский, рамка должна максимально соответствовать реальному положению и границам объекта.
Для простых алгоритмов поиска ключевых точек лучше выбирать объекты с большим количеством текстур.

## Теоритический обзор
### SIFT
SIFT — алгоритм обнаружения и описания ключевых точек изображения, устойчивый к масштабированию, повороту и частично — к изменению освещения. Алгоритм включает следующие этапы:
* построение пирамиды разностей гауссианов (DoG);
* поиск экстремумов в пространстве масштабов;
* фильтрация нестабильных точек;
* вычисление ориентации и дескрипторов ключевых точек.
SIFT позволяет получать информативные и устойчивые дескрипторы, что делает его удобным для начальной инициализации трекинга.

### Гомография
Гомография — это проективное преобразование, описывающее отображение одной плоскости в другую. В контексте компьютерного зрения гомография используется для:

- сопоставления изображений плоских объектов;
- определения изменения положения объекта между кадрами;
- проецирования границ объекта на новое изображение.

Матрица гомографии размером 3×3 вычисляется по набору соответствующих точек, обычно с применением алгоритма RANSAC для устойчивости к выбросам.

### KLT трекинг
Алгоритм Канаде–Люкаса–Томаси (KLT) предназначен для отслеживания движения характерных точек между последовательными кадрами видео. Он основан на предположении малых смещений и постоянства яркости.

Для повышения надёжности применяется:
- пирамидальная версия алгоритма;
- прямой и обратный трекинг (forward-backward check), позволяющий отбрасывать некорректно отслеженные точки.
KLT эффективен для кратковременного трекинга большого количества точек в реальном времени.

## Описание системы

Разработанная система работает следующим образом:
- Из первого кадра видео (или отдельного изображения) извлекаются ключевые точки с помощью алгоритма SIFT.
- Ключевые точки преобразуются в формат, подходящий для KLT-трекинга.
 
- На каждом следующем кадре выполняется:
  - прямой трекинг точек;
  - обратный трекинг для проверки согласованности;
  - фильтрация некорректных точек.

- По корректно отслеженным точкам вычисляется матрица гомографии.
- Границы объекта, заданные в первом кадре, проецируются на текущий кадр.
- На изображении отображается рамка объекта и дополнительная информация.
- При потере значительного числа точек выполняется повторное обнаружение ключевых точек.

Результатом работы является видеофайл с визуализацией трекинга объекта.
## Результаты
Проанализированы 4 видео (приложены)

## Выводы
1. Была спроектирована система для работы с видео для трекинга
2. Реализован SIFT алгоритм

## Литература
1. https://habr.com/ru/articles/106302/
2. https://engee.com/helpcenter/stable/ru/interactive-scripts/image_processing/orb.html
3. https://habr.com/ru/articles/244541/
4. https://docs.opencv.org/4.x/da/df5/tutorial_py_sift_intro.html
5. https://mpolinowski.github.io/docs/IoT-and-Machine-Learning/ML/2021-12-10--opencv-optical-flow-tracking/2021-12-10/
